---
title: "エラーおよび警告の処理、SQLSRV ドライバーを使用して構成する |Microsoft ドキュメント"
ms.custom: 
ms.date: 01/19/2017
ms.prod: sql-non-specified
ms.prod_service: drivers
ms.service: 
ms.component: php
ms.reviewer: 
ms.suite: sql
ms.technology:
- drivers
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- errors and warnings
ms.assetid: 257c6f53-9137-4619-a613-eee33d2077e8
caps.latest.revision: 20
author: MightyPen
ms.author: genemi
manager: jhubbard
ms.workload: Inactive
ms.translationtype: MT
ms.sourcegitcommit: f7e6274d77a9cdd4de6cbcaef559ca99f77b3608
ms.openlocfilehash: 7bd1429337a1a73bc84a96fb92c12842deff506c
ms.contentlocale: ja-jp
ms.lasthandoff: 09/09/2017

---
# <a name="how-to-configure-error-and-warning-handling-using-the-sqlsrv-driver"></a>方法: SQLSRV ドライバーを使用してエラーおよび警告処理を構成する
[!INCLUDE[Driver_PHP_Download](../../includes/driver_php_download.md)]

このトピックでは、エラーと警告を処理するために SQLSRV ドライバーを構成する方法について説明します。  
  
既定で、SQLSRV ドライバーは警告をエラーとして扱います。エラーまたは警告を生成する **sqlsrv** 関数の呼び出しは **false**を返します。 この動作を無効にするを使用して、 [sqlsrv_configure](../../connect/php/sqlsrv-configure.md)関数。 次のコード行が、スクリプトの先頭に含まれるときに、 **sqlsrv**警告 (エラーなし) のみを生成する関数は返されません**false**:  
  
`sqlsrv_configure("WarningsReturnAsErrors", 0);`  
  
次のコード行は既定の動作 (警告はエラーとして扱われる) をリセットします。  
  
`sqlsrv_configure("WarningsReturnAsErrors", 1);`  
  
> [!NOTE]  
> SQLSTATE 値 01000、01001、01003、および 01S02 に対応する警告はエラーとして扱われません。 構成に関係なく、これらのいずれかの状態に対応する警告のみを生成する **sqlsrv** 関数は **false**を返しません。  
  
**WarningsReturnAsErrors** の値は php.ini ファイル内にも設定できます。 たとえば、php.ini ファイルの `[sqlsrv]` セクション内のこのエントリは、既定の動作をオフにします。  
  
`sqlsrv.WarningsReturnAsErrors = 0`  
  
エラーおよび警告情報の取得については、 [sqlsrv_errors](../../connect/php/sqlsrv-errors.md) と「 [方法: エラーと警告の処理](../../connect/php/how-to-handle-errors-and-warnings-using-the-sqlsrv-driver.md)」を参照してください。  
  
## <a name="example"></a>例  
次のコード例は、既定のエラー処理動作を無効にする方法を示しています。 例では、Transact-SQL PRINT コマンドを使用して、警告を生成しています。 [印刷] コマンドの詳細については、次を参照してください。 [PRINT (TRANSACT-SQL)](http://go.microsoft.com/fwlink/?linkid=119518)です。  
  
例では、まず警告を生成するクエリを実行して、既定のエラー処理動作を説明しています。 この警告はエラーとして扱われます。 エラー処理の設定を変更した後に、同じクエリが実行されます。 警告はエラーとして扱われません。  
  
この例では、SQL Server がローカル コンピューターにインストールされていることを前提にしています。 コマンド ラインからこの例を実行すると、すべての出力はコンソールに書き込まれます。  
  
```  
<?php  
/* Connect to the local server using Windows Authentication. */  
$serverName = "(local)";  
$conn = sqlsrv_connect( $serverName );  
if( $conn === false )  
{  
     echo "Could not connect.\n";  
     die( print_r( sqlsrv_errors(), true));  
}  
  
/* The Transact-SQL PRINT statement can be used to return   
informational or warning messages*/  
$tsql = "PRINT 'The PRINT statement can be used ";  
$tsql .= "to return user-defined warnings.'";  
  
/* Execute the query and print any errors. */  
$stmt1 = sqlsrv_query( $conn, $tsql);  
if($stmt1 === false)  
{  
     echo "By default, warnings are treated as errors:\n";  
     /* Dump errors in the error collection. */  
     print_r(sqlsrv_errors(SQLSRV_ERR_ERRORS));  
}  
  
/* Disable warnings as errors behavior. */  
sqlsrv_configure("WarningsReturnAsErrors", 0);  
  
/* Execute the same query and print any errors. */  
$stmt2 = sqlsrv_query( $conn, $tsql);  
if($stmt2 === false)  
{  
     /* Dump errors in the error collection. */  
     /* Since the warning generated by the query will not be treated as   
        an error, this block of code will not be executed. */  
     print_r(sqlsrv_errors(SQLSRV_ERR_ERRORS));  
}  
else  
{  
     echo "After calling ";  
     echo "sqlsrv_configure('WarningsReturnAsErrors', 0), ";  
     echo "warnings are not treated as errors.";  
}  
  
/*Close the connection. */  
sqlsrv_close($conn);  
?>  
```  
  
## <a name="see-also"></a>参照  
[アクティビティのログ記録](../../connect/php/logging-activity.md)  
[プログラミング ガイド](../../connect/php/programming-guide-for-php-sql-driver.md)
[SQLSRV ドライバー API リファレンス](../../connect/php/sqlsrv-driver-api-reference.md)  
  

