---
title: "マージ レプリケーション | Microsoft Docs"
ms.custom: ""
ms.date: "03/14/2017"
ms.prod: "sql-server-2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "replication"
ms.tgt_pltfrm: ""
ms.topic: "article"
helpviewer_keywords: 
  - "マージ レプリケーション [SQL Server レプリケーション], マージ レプリケーションについて"
  - "マージ レプリケーション [SQL Server レプリケーション]"
ms.assetid: ff87c368-4c00-4e48-809d-ea752839551e
caps.latest.revision: 34
author: "BYHAM"
ms.author: "rickbyh"
manager: "jhubbard"
caps.handback.revision: 34
---
# マージ レプリケーション
  一般にマージ レプリケーションは、トランザクション レプリケーションと同様に、パブリケーションのデータベース オブジェクトとデータのスナップショットで開始されます。 その後にパブリッシャーとサブスクライバーで行われたデータおよびスキーマの変更は、トリガーを使って追跡されます。 サブスクライバーは、ネットワークに接続されたときにパブリッシャーと同期して、前回の同期以降にパブリッシャーとサブスクライバーの間で変更されたすべての行を交換します。  
  
 マージ レプリケーションは、一般にサーバー対クライアント環境で使用されます。 マージ レプリケーションは、以下の状況に適しています。  
  
-   複数のサブスクライバーで別々の時刻に同じデータを更新し、それらの変更をパブリッシャーや他のサブスクライバーに反映する場合がある。  
  
-   サブスクライバーで、データを受信し、オフラインで変更を行い、後でパブリッシャーおよび他のサブスクライバーと変更を同期する必要がある。  
  
-   各サブスクライバーが、データの別々の部分を必要とする。  
  
-   競合が発生する可能性があり、発生した場合にはそれを検出して解決できる必要がある。  
  
-   アプリケーションで、中間状態のデータにアクセスするのではなく、最終的な変更結果が必要である。 たとえば、サブスクライバーでパブリッシャーと同期する前に行が 5 回変更された場合、最終的な変更結果 (つまり、5 回目の値) を反映させるために、パブリッシャーでは 1 回だけ変更されます。  
  
 マージ レプリケーションでは、さまざまなサイトが自律的に動作し、更新内容が後で 1 つにマージされます。 更新は複数のノードで発生するため、パブリッシャーおよび複数のサブスクライバーで同じデータが更新されている場合があります。 したがって、更新をマージする際に競合が発生する可能性があるため、マージ レプリケーションには競合を処理するいくつかの方法が用意されています。  
  
 マージ レプリケーションは、[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] スナップショット エージェントおよびマージ エージェントによって実装されます。 パブリケーションがフィルター選択されていない場合や静的フィルターを使用している場合、スナップショット エージェントでは 1 つのスナップショットが作成されます。 パブリケーションがパラメーター化されたフィルターを使用している場合、スナップショット エージェントではデータのパーティションごとに 1 つのスナップショットが作成されます。 マージ エージェントは、初期スナップショットをサブスクライバーに適用します。 また、初期スナップショットの作成後にパブリッシャーまたはサブスクライバーで発生したデータの増分変更がマージされ、ユーザーが構成したルールに従って競合を検出し、解決します。  
  
 変更を追跡するため、マージ レプリケーション (およびキュー更新サブスクリプションを使用したトランザクション レプリケーション) では、パブリッシュされたすべてのテーブルのすべての行を一意に識別できる必要があります。 このマージを実行する列をレプリケーションに追加 **rowguid** すべてのテーブルにテーブルにデータ型の列があるない場合、 **uniqueidentifier** で、 **ROWGUIDCOL** プロパティ (この列を使用する場合) を設定します。 テーブルがパブリケーションから削除される場合、 **rowguid** 列も削除されます。 追跡のための既存の列を使用している場合、列は削除されません。 フィルターには、レプリケーションで行の識別に使用される **rowguidcol** を含めることはできません。  **Newid()** の既定値として用意されている関数、 **rowguid** ] 列で、ただし顧客が備わって guid 行ごとに必要な場合です。 ただし、値 00000000-0000-0000-0000-000000000000 を行いません。  
  
 次の図は、マージ レプリケーションで使用されるコンポーネントを示しています。  
  
 ![マージ レプリケーション コンポーネントとデータ フロー](../../../relational-databases/replication/merge/media/merge.gif "マージ レプリケーション コンポーネントとデータ フロー")  
  
  