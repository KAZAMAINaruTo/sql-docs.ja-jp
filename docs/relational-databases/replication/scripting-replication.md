---
title: "レプリケーションのスクリプト作成 | Microsoft Docs"
ms.custom: ""
ms.date: "03/14/2017"
ms.prod: "sql-server-2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "replication"
ms.tgt_pltfrm: ""
ms.topic: "article"
helpviewer_keywords: 
  - "スクリプト [SQL Server レプリケーション], レプリケーション オブジェクト"
  - "マージ レプリケーションのスクリプト作成 [SQL Server レプリケーション]"
  - "レプリケーション [SQL Server], スクリプトの作成"
  - "スナップショット レプリケーション [SQL Server], スクリプト"
  - "スクリプト [SQL Server レプリケーション]"
  - "トランザクション レプリケーション, スクリプト"
ms.assetid: e50fac44-54c0-470c-a4ea-9c111fa4322b
caps.latest.revision: 36
author: "BYHAM"
ms.author: "rickbyh"
manager: "jhubbard"
caps.handback.revision: 36
---
# レプリケーションのスクリプト作成
  トポロジ内のすべてのレプリケーション コンポーンネントは、災害復旧計画の一部としてスクリプト化され、スクリプトはタスクの繰り返しの自動化にも使用することができます。 スクリプトには、パブリケーションやサブスクリプションなどスクリプト化されたレプリケーション コンポーネントを実装するために必要な Transact-SQL システム ストアド プロシージャが格納されます。 スクリプトを作成できます (パブリケーションの新規作成ウィザード) などのウィザードまたは [ [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] コンポーネントを作成した後です。 表示、変更、およびスクリプトを使用して実行 [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] または **sqlcmd**します。 スクリプトをバックアップ ファイルと共に保存して、レプリケーション トポロジの再構成が必要な場合に使用できます。  
  
 プロパティが変更された場合は、コンポーネントのスクリプトを再作成する必要があります。 トランザクション レプリケーションでカスタム ストアド プロシージャを使用している場合は、各プロシージャのコピーをスクリプトと共に保存しておく必要があります。プロシージャが変更された場合は、プロシージャのコピーも更新する必要があります (スキーマやアプリケーション要件が変更されると、通常、プロシージャが更新されます)。 カスタム プロシージャの詳細については、次を参照してください。 [トランザクション アーティクルに変更を反映する方法を指定](../../relational-databases/replication/transactional/specify-how-changes-are-propagated-for-transactional-articles.md)します。  
  
 パラメーター化されたフィルターを使用するマージ パブリケーションの場合、パブリケーション スクリプトには、データ パーティションを作成するためのストアド プロシージャの呼び出しが含まれます。 このスクリプトによって、作成されたパーティションの参照、および必要に応じて 1 つ以上のパーティションを再作成する方法を利用できます。  
  
## スクリプトによるタスクの自動化の例  
 たとえば、[!INCLUDE[ssSampleDBCoFull](../../includes/sssampledbcofull-md.md)] では、リモートの営業部門にデータを配信するマージ レプリケーションを実装しているとします。 営業担当者は、プル サブスクリプションを使用して自分の販売区域内の顧客に関連するすべてのデータをダウンロードします。 オフラインで作業しているときには、データを更新したり、新しい顧客や受注を入力することができます。 [!INCLUDE[ssSampleDBCoFull](../../includes/sssampledbcofull-md.md)] には、さまざまな区域に 50 人を超える営業担当者がいるため、サブスクリプションの新規作成ウィザードを使用してサブスクライバーごとにさまざまなサブスクリプションを作成するには時間がかかります。 代わりに、レプリケーション管理者は次の手順を実行します。  
  
1.  営業担当者または販売区域に基づいたパーティションで必要なマージ パブリケーションを設定します。  
  
2.  1 つのサブスクライバーに対して 1 つのプル サブスクリプションを作成します。  
  
3.  作成したプル サブスクリプションに基づいてスクリプトを生成します。  
  
4.  スクリプトを変更し、サブスクライバーの名前などの値を変更します。  
  
5.  複数のサブスクライバーでスクリプトを実行し、必要なプル サブスクリプションを生成します。  
  
## レプリケーション オブジェクトのスクリプトの作成  
 レプリケーション ウィザードからのレプリケーション オブジェクトのスクリプト、 **レプリケーション** フォルダーに [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]します。 ウィザードからスクリプトを作成する場合は、オブジェクトの作成後にスクリプトを作成するか、スクリプトの作成のみを行うかを選択することができます。  
  
> [!IMPORTANT]  
>  すべてのパスワードは NULL としてスクリプトが作成されます。 可能であれば、実行時、ユーザーに対してセキュリティ資格情報の入力を要求します。 スクリプト ファイルに資格情報を格納する場合は、不正アクセスを防ぐために、そのファイルをセキュリティで保護する必要があります。  
  
 レプリケーション ウィザードの使用方法の詳細については、以下を参照してください。  
  
-   [Configure Publishing and Distribution](../../relational-databases/replication/configure-publishing-and-distribution.md)  
  
-   [Create a Publication](../../relational-databases/replication/publish/create-a-publication.md)  
  
-   [Create a Push Subscription](../../relational-databases/replication/create-a-push-subscription.md)  
  
-   [Create a Pull Subscription](../../relational-databases/replication/create-a-pull-subscription.md)  
  
#### レプリケーション ウィザードからオブジェクトのスクリプトを作成するには  
  
1.   **ウィザードのアクション** ページ、ウィザードのウィザードの適切なチェック ボックスをオンにします。  
  
    -   **[パブリケーションを作成するためのステップを含むスクリプト ファイルを生成する]**  
  
    -   **[サブスクリプションを作成するためのステップを含むスクリプト ファイルを生成する]**  
  
    -   **[ディストリビューションを構成するためのステップを含むスクリプトを生成する]**  
  
2.  オプションを指定、 **スクリプト ファイルのプロパティ** ページです。  
  
3.  ウィザードを完了します。  
  
#### Management Studio からオブジェクトのスクリプトを作成するには  
  
1.  [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)] でディストリビューター、パブリッシャー、またはサブスクライバーに接続し、サーバー ノードを展開します。  
  
2.  展開、 **レプリケーション** フォルダーの順に展開し、 **ローカル パブリケーション** フォルダーまたは **ローカル サブスクリプション** フォルダーです。  
  
3.  パブリケーションまたはサブスクリプションを右クリックし、をクリックし、 **スクリプトの生成**します。  
  
4.  オプションを指定、 **SQL スクリプトの生成 - \< ReplicationObject>** ] ダイアログ ボックス。  
  
5.  クリックして **スクリプトをファイルに**します。  
  
6.  ファイルの名前を入力、 **スクリプト ファイルの場所** クリックしてダイアログ ボックスで、 **保存**します。 状態メッセージが表示されます。  
  
7.  をクリックして **OK**, 、順にクリック **閉じる**します。  
  
#### Management Studio から複数のオブジェクトのスクリプトを作成するには  
  
1.  [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)] でディストリビューター、パブリッシャー、またはサブスクライバーに接続し、サーバー ノードを展開します。  
  
2.  右クリックし、 **レプリケーション** フォルダー、およびクリック **スクリプトの生成**します。  
  
3.  オプションを指定、 **SQL スクリプトの生成** ] ダイアログ ボックス。  
  
4.  クリックして **スクリプトをファイルに**します。  
  
5.  ファイルの名前を入力、 **スクリプト ファイルの場所** クリックしてダイアログ ボックスで、 **保存**します。 状態メッセージが表示されます。  
  
6.  クリックして **[ok] をし** ] をクリックして **閉じる**します。  
  
  