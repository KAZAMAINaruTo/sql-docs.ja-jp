---
title: "Web 同期用の IIS の構成 | Microsoft Docs"
ms.custom: ""
ms.date: "03/14/2017"
ms.prod: "sql-server-2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "replication"
ms.tgt_pltfrm: ""
ms.topic: "article"
helpviewer_keywords: 
  - "IIS サーバーの構成 [SQL Server レプリケーション]"
  - "websync.log"
  - "Web 同期, IIS サーバー"
ms.assetid: d651186e-c9ca-4864-a444-2cd6943b8e35
caps.latest.revision: 88
author: "BYHAM"
ms.author: "rickbyh"
manager: "jhubbard"
caps.handback.revision: 88
---
# Web 同期用の IIS の構成
  ここでは、マージ レプリケーション用に Web 同期を構成する 2 番目の手順を説明します。 この手順は、Web 同期用にパブリケーションを有効にした後に実行します。 構成プロセスの概要については、次を参照してください。 [Web 同期の構成](../../relational-databases/replication/configure-web-synchronization.md)します。 ここでの手順を完了したら、続いて、Web 同期が使用されるようにサブスクリプションを構成する 3 番目の手順を実行してください。 3 番目の手順については、次のトピックで説明します。  
  
-   [!含める [ssManStudioFull] (../Token/ssManStudioFull_md.md)]: [How to: Configure a Subscription to Use Web Synchronization \(SQL Server Management Studio\)](http://msdn.microsoft.com/library/ms345214.aspx)  
  
-   レプリケーション [!INCLUDE[tsql](../../includes/tsql-md.md)] プログラミング: [方法: Web 同期 (レプリケーション TRANSACT-SQL プログラミング) を使用するサブスクリプションを構成します。](http://msdn.microsoft.com/library/ms345206.aspx)  
  
-   RMO: [方法: Web 同期 (RMO プログラミング) を使用するサブスクリプションを構成します。](http://msdn.microsoft.com/library/ms345207.aspx)  
  
 Web 同期では、[!INCLUDE[msCoName](../../includes/msconame-md.md)] インターネット インフォメーション サービス (IIS) を実行するコンピューターを使用して、プル サブスクリプションをマージ パブリケーションに同期します。 IIS バージョン 5.0、IIS 6.0、および [!INCLUDE[iisver](../../includes/iisver-md.md)] はサポートされています。 [!INCLUDE[iisver](../../includes/iisver-md.md)] では、Web 同期の構成ウィザードはサポートされません。  
  
> [!IMPORTANT]  
>  アプリケーションで [!INCLUDE[dnprdnlong](../../includes/dnprdnlong-md.md)] 以降のバージョンのみが使用されることと、 [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)] の以前のバージョンが IIS サーバーにインストールされていないことを確認します。 [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)] の以前のバージョンを使用するとエラーが発生する可能性があります。 たとえば、"Web 同期中のメッセージの形式が無効でした。 Web サーバーでレプリケーション コンポーネントが正しく構成されていることを確認してください。" というエラーなどです。  
  
> [!CAUTION]  
>  WebSync と代替スナップショット フォルダーの場所を同時に使用しないでください。  
  
 Web 同期を使用するには、次の手順を完了して IIS を構成する必要があります。 ここでは、各手順を詳しく説明します。  
  
1.  SSL (Secure Sockets Layer) を構成します。 IIS とすべてのサブスクライバー間の通信には SSL が必要です。  
  
2.  インストール [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] を使用して IIS を実行しているコンピューターに接続コンポーネント、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] インストール ウィザード。 手順 3. で説明する Web 同期の構成ウィザードを使用する場合は、IIS を実行しているコンピューターに [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] もインストールする必要があります。  
  
3.  IIS を実行しているコンピューターを Web 同期用に構成します。 手動でコンピューターを構成するか、Web 同期の構成ウィザードを使用できます。 ウィザードを使用することをお勧めします。  
  
    > [!NOTE]  
    >  IIS を実行しているコンピューターで、64 ビット バージョンの Windows を実行している場合は、以下のコマンドを実行して、ISAPI (インターネット サーバー API) アプリケーションを実行できるようにサーバーを適切に構成する必要があります。 詳細については、IIS のマニュアルを参照してください。  
  
    ```  
    cscript %SystemDrive%\inetpub\AdminScripts\adsutil.vbs set w3svc/AppPools/Enable32bitAppOnWin64 1  
    ```  
  
4.  [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] レプリケーション リスナーに適切な権限を設定します。  
  
5.  診断モードで Web 同期を実行し、IIS を実行しているコンピューターへの接続をテストして、SSL 証明書が正しくインストールされることを確認します。  
  
## Secure Sockets Layer の構成  
 SSL を構成するには、IIS を実行しているコンピューターが使用する証明書を指定する必要があります。 マージ レプリケーション用の Web 同期では、サーバー証明書のみがサポートされており、クライアント証明書はサポートされていません。 配置用に IIS を構成するには、最初に証明機関 (CA) から証明書を取得する必要があります。 証明機関とは、ユーザー、コンピューター、およびその他の証明機関に属する公開暗号化キーの正当性の証明および保証を行う機関のことです。 証明書の詳細については、IIS のマニュアルを参照してください。 証明書をインストールしたら、その証明書を Web 同期で使用する Web サイトと関連付ける必要があります。  
  
#### 配置用に証明書を指定するには  
  
1.  IIS を実行しているコンピューターに管理者としてログオンします。  
  
2.  開始 **インターネット インフォメーション サービス (IIS) マネージャー**:  
  
    1.  クリックして **開始**, 、順にクリック **実行**します。  
  
    2.   **開く** ボックスに、入力 **inetmgr**, 、順にクリック **OK**します。  
  
3.  IIS 証明書ウィザードを実行します。  
  
    1.   **インターネット インフォメーション サービス (IIS) マネージャー**, 、展開、 **ローカル コンピューター** ノードを順に展開、 **Web サイト** フォルダーです。  
  
    2.  右クリック **既定の Web サイト**, 、クリックして **プロパティ**します。  
  
    3.   **Web サイトのプロパティの既定の** ] ダイアログ ボックスの [、 **ディレクトリ セキュリティ** ] タブ、[ **サーバー証明書**します。  
  
    4.  Web サーバー証明書ウィザードを実行します。  
  
4.  クリックして **OK**です。  
  
 CA からサーバー証明書を取得できない場合は、テスト用に証明書を指定できます。 テスト用に IIS 6.0 を構成するには、SelfSSL ユーティリティを使用して証明書をインストールします。 このユーティリティは、IIS 6.0 リソース キットで使用できます。 含まれるツールをダウンロードすることができます、 [Microsoft ダウンロード センター](http://go.microsoft.com/fwlink/?LinkId=30958)します。 IIS 5.0 を参照してください [Microsoft ヘルプとサポート](http://go.microsoft.com/fwlink/?LinkId=46229)します。  
  
> [!NOTE]  
>  Web サイトで SSL を使用できるようにするには、事前に証明書を Web サイトに関連付ける必要があります。 SelfSSL を使用すると、証明書が既定の Web サイトに自動的に関連付けられます。 既に証明書を保有しているか、または後で CA から証明書をインストールする場合は、証明書を Web 同期で使用する Web サイトと明示的に関連付ける必要があります。 サブスクリプションの同期に使用する Web サイトに関連付けられた証明書が 1 つしか存在しないことを確認します。 複数の証明書が存在する場合、サブスクライバーは使用可能な最初の Web サイトを使用します。  
  
#### IIS 6.0 でテスト用に証明書を指定するには  
  
1.  IIS を実行しているコンピューターに管理者としてログオンします。  
  
2.  SelfSSL をダウンロードしてインストールします。 既定では、アプリケーションのインストール先は \<*ドライブ*>: \Program Files\IIS resources \selfssl です。 アプリケーションおよびマニュアルのショートカットにコピー \<*ドライブ*>: \Documents and \all users \start menu \programs\iis resources \selfssl です。  
  
3.  SelfSSL を実行します。  
  
    -   すべてのパラメーターに既定値を指定して SelfSSL を実行するには、アプリケーションのインストール ディレクトリに移動して、SelfSSL.exe をダブルクリックします。  
  
        > [!NOTE]  
        >  SelfSSL を使用してインストールした証明書の既定の有効期限は 7 日間です。  
  
    -   1 つまたは複数のパラメーターの値を指定する:] をクリックして **開始**, 、] をクリックし、 **実行**します。  **開いている** ボックスに、入力 **cmd**, 、順にクリック **OK**します。 SelfSSL のインストール ディレクトリに移動して「`SelfSSL`」と入力し、1 つ以上のパラメーターの値を指定します。 パラメーターの一覧を確認する場合は、「`SelfSSL -?`」と入力します。  
  
## 接続コンポーネントと SQL Server Management Studio のインストール  
  
#### SQL Server 接続コンポーネントと SQL Server Management Studio をインストールするには  
  
1.  IIS を実行しているコンピューターに管理者としてログオンします。  
  
2.  [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] インストール ディスクから [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] インストール ウィザードを起動します。 このウィザードの使用に関する詳細については、次を参照してください [#40; インストール ウィザードからの SQL Server 2016 のインストール。セットアップと #41;](../../database-engine/install-windows/install-sql-server-2016-from-the-installation-wizard-setup.md)します。  
  
3.   **機能の選択** ] ページで、[ **クライアント ツール接続**します。  
  
4.  Web 同期の構成ウィザードを使用する場合は、選択 **管理ツール - 基本**します。  
  
5.  ウィザードを終了して、コンピューターを再起動します。  
  
    > [!NOTE]  
    >  他のコンポーネントをインストールすることもできますが、Web 同期で必要なのは接続コンポーネントだけです。  
  
## Web 同期の構成ウィザードを使用した、IIS を実行しているコンピューターの構成  
 Web 同期の構成ウィザードを使用して、IIS サーバーを構成します。 このウィザードを使用することをお勧めしますが、次のセクションで手動での構成の手順も説明します。 [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] に付属する Web 同期ウィザードは、[!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] を実行中のパブリッシャーまたは [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] にアップグレードされたパブリッシャーで作成されたパブリケーションのみに使用できます。 このウィザードは、[!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] のパブリケーションには使用できません。 このウィザードは、[!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 以降のバージョンおよび [!INCLUDE[ssEWnoversion](../../includes/ssewnoversion-md.md)] 3.0 以降のバージョンのサブスクリプションで使用できます。  
  
 この構成の特徴は次のとおりです。  
  
-   IIS で既定の Web サイトを使用します。 ただし、別の Web サイトを使用することもできます。 Web サイトを作成する方法の詳細については、IIS のマニュアルを参照してください。  
  
    > [!NOTE]  
    >  指定した Web サイトから Web 同期で使用するコンポーネントにアクセスできます。 Web サイトの構成を行わなければ、そのサイトで他のデータや Web ページにアクセスすることはできません。  
  
-   仮想ディレクトリおよびこのディレクトリに関連付けられた別名を作成します。 この別名は、Web 同期コンポーネントにアクセスするときに使用されます。 たとえば、IIS のアドレスが https://*server.domain.com* を"websync1"エイリアスを入力すると、replisapi.dll コンポーネントにアクセスするアドレスは https:// と*server.domain.com*/websync1/replisapi.dll します。  
  
-   基本認証を使用します。 基本認証の使用をお勧めする理由は、基本認証では、Kerberos 委任を必要とすることなく、IIS と [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] パブリッシャーまたはディストリビューターを別々のコンピューターで実行すること (推奨の構成) が可能になるからです。 基本認証を使用した SSL では、ログインやパスワードなどすべてのデータが暗号化されて送信されます  (使用する認証の種類にかかわらず、SSL は必須です)。Web 同期のベスト プラクティスについての詳細については、「ベスト プラクティス Web 同期のセキュリティ」セクションを参照してください [Web 同期の構成](../../relational-databases/replication/configure-web-synchronization.md)します。  
  
#### Web 同期の構成ウィザードを使用して IIS を実行しているコンピューターを構成するには  
  
1.  IIS を実行しているコンピューターで、[!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] を起動します。  
  
2.  パブリッシャーに接続し、サーバー ノードを展開します。  
  
3.  展開、 **ローカル パブリケーション** フォルダーは、パブリケーションを右クリックし、をクリックして **Web 同期の構成**します。  
  
4.  Web 同期の構成ウィザードで、 **サブスクライバーの種類** ] ページで、[ **SQL Server**します。  
  
5.   **Web サーバー** ページ。  
  
    1.  サブスクリプションを同期する IIS のインスタンスを選択します。  
  
    2.  選択 **新しい仮想ディレクトリを作成**します。  
  
    3.  ページの下部のウィンドウで IIS のインスタンスを展開し、 **Websites**, 、] をクリックし、 **既定の Web サイト**します。  
  
6.   **仮想ディレクトリ情報** ページ。  
  
    1.   **エイリアス** ボックスで、仮想ディレクトリのエイリアスを入力します。  
  
    2.   **パス** ボックスで、仮想ディレクトリのパスを入力します。 たとえば、入力した **websync1** で、 **エイリアス** ボックスに、入力 **C:\Inetpub\wwwroot\websync1** で、 **パス** ボックス。 **[次へ]**をクリックします。  
  
    3.  両方のダイアログ ボックスをクリックして **はい**します。 これにより、新しいフォルダーを作成し、[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ISAPI (インターネット サーバー API) の DLL をコピーします。 」を参照してください。  
  
7.   **認証済みアクセス** ページ。  
  
    1.  確認して **統合 Windows 認証** と **の Windows ドメイン サーバーでダイジェスト認証** がオフになっています。  
  
    2.  選択 **基本認証**します。  
  
    3.   **既定のドメイン** と **レルム** ボックスに IIS を実行しているコンピューターのドメインを入力します。  
  
8.   **ディレクトリ アクセス** ページ。  
  
    1.  をクリックして **追加**, 、し、次に、 **[ユーザーまたはグループ** ] ダイアログ ボックスで、アカウントを追加するサブスクライバーが接続を IIS にします。 これらのアカウントが、上の指定は、 **Web サーバー情報** の値またはサブスクリプションの新規作成ウィザードのページ、 [sp_addmergepullsubscription_agent](../../relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql.md)*@internet_login* パラメーター。  
  
9.  **スナップショット共有へのアクセス** ] ページで、スナップショット共有を入力します。 サブスクライバーがスナップショット ファイルにアクセスできるように、この共有に適切な権限を設定します。 共有の権限の詳細については、次を参照してください。 [スナップショット フォルダーをセキュリティで保護された](../../relational-databases/replication/security/secure-the-snapshot-folder.md)します。  
  
10.  **ウィザードの完了** ] ページで [ **完了**します。  
  
     IIS を実行しているリモート コンピューターの構成中に発生したネットワーク エラーなど、何らかの障害が発生した場合、完了済みの操作はすべてロールバックされ、残りの操作は中止されます。 完了済みの操作はロールバックできません、ウィザードで、表示の最後のページで状態場合 **成功** し、完了済みの操作は引き続きコミットされています。  
  
11. IIS を実行しているコンピューターで、64 ビット バージョンの Windows を実行している場合、replisapi.dll を適切なディレクトリにコピーする必要があります。  
  
    1.  クリックして **開始**, 、順にクリック **実行**します。  **開いている** ボックスに、入力 **iisreset**, 、順にクリック **OK**します。  
  
    2.  IIS が停止して再起動したら、[!INCLUDE[ssInstallPathVar](../../includes/ssinstallpathvar-md.md)]COM\replisapi から手順 6b. で指定したディレクトリに replisapi.dll をコピーします。  
  
    3.  クリックして **開始**, 、順にクリック **実行**します。  **開いている** ボックスに、入力 **cmd**, 、順にクリック **OK**します。  
  
    4.  手順 6b. で指定したディレクトリで、次のコマンドを実行します。  
  
         **regsvr32 replisapi.dll**  
  
## IIS を実行しているコンピューターの手動の構成  
 IIS を実行しているコンピューターを手動で構成するには、[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] レプリケーション リスナーをインストールおよび構成し、IIS に接続するサブスクライバーの認証を構成する必要があります。  
  
#### SQL Server レプリケーション リスナーのインストールと構成を行うには  
  
1.  IIS を実行しているコンピューターに、replisapi.dll を格納するファイル ディレクトリを作成します。 ディレクトリを作成するには、下のディレクトリを作成することをお勧めするは、どこに、\<*ドライブ*>: \Inetpub ディレクトリ。 たとえば、ディレクトリを作成 \<*ドライブ*>: \Inetpub\SQLReplication\\します。  
  
    > [!IMPORTANT]  
    >  FAT ファイル システム パーティションではなく NTFS ファイル システム パーティションにこのディレクトリを作成することを強くお勧めします。 NTFS ファイル システムであれば、NTFS ファイル システムのファイル アクセス許可を使用して、[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] レプリケーションにアクセスできるユーザーを厳密に制御することができます。  
  
2.  replisapi.dll を [!INCLUDE[ssInstallPathVar](../../includes/ssinstallpathvar-md.md)]com\ ディレクトリから、手順 1. で作成したファイル ディレクトリにコピーします。  
  
3.  次の手順に従って replisapi.dll を登録します。  
  
    1.  クリックして **開始**, 、順にクリック **実行**します。  **開いている** ボックスに、入力 **cmd**, 、順にクリック **OK**します。  
  
    2.  手順 1. で作成したディレクトリで、次のコマンドを実行します。  
  
         **regsvr32 replisapi.dll**  
  
4.  レプリケーション用の新しい Web サイトを作成するか、既存のサイトを使用します。 Web サイトは、同期の際にレプリケーション コンポーネントからアクセスされます。 Web サイトを作成する方法の詳細については、IIS のマニュアルを参照してください。  
  
5.  IIS で仮想ディレクトリを作成します。 仮想ディレクトリは、手順 4. で作成した Web サイトの下に作成し、手順 1. で作成したディレクトリにマッピングします。 仮想ディレクトリを作成する方法の詳細については、IIS のマニュアルを参照してください。 このディレクトリに割り当てる権限は、最小限にすることをお勧めします。 選択する必要があります **読み取り** と **Execute** アクセス許可、しなくてもかまいません **スクリプトを実行する**, 、**書き込み**, と **参照** アクセス許可。  
  
6.  replisapi.dll を実行できるように IIS を構成します。 手順 4. で割り当てた権限は、以前のバージョンの IIS では十分ですが、IIS バージョン 6.0 では ISAPI (インターネット サーバー API) 拡張を有効にする必要があります。 詳細については、IIS 6.0 のマニュアルの「ISAPI 拡張を構成する」および「動的コンテンツを有効および無効にする」を参照してください。  
  
#### IIS 認証を構成するには  
  
-   サブスクライバーが IIS に接続するには、サブスクライバーがリソースやプロセスにアクセスする前に、IIS がサブスクライバーを認証する必要があります。 IIS では、匿名認証、基本認証、統合認証の 3 種類の認証方式が用意されています。 認証は、Web サイト全体または作成した特定の仮想ディレクトリに適用することができます。  
  
     基本認証と SSL を組み合わせて使用することをお勧めします。 使用する認証の種類にかかわらず、SSL は必須です。 認証を構成する方法の詳細については、IIS のマニュアルを参照してください。  
  
## SQL Server レプリケーション リスナーの権限の設定  
 サブスクライバーが IIS を実行しているコンピューターに接続するときは、IIS の構成時に指定した認証の種類を使用して、サブスクライバーが認証されます。 IIS はサブスクライバーを認証した後、サブスクライバーに [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] レプリケーションを実行する権限があるかどうかを確認します。 replisapi.dll の権限を設定して、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] レプリケーションを実行できるユーザーを制御します。 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] レプリケーションに許可なくアクセスされることがないように権限を正しく構成する必要があります。  
  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] レプリケーション リスナーの実行に使用するアカウントを最小の権限で構成するには、次の手順を完了する必要があります。 手順で、手順を利用 [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[winxpsvr](../../includes/winxpsvr-md.md)] IIS 6.0 を実行します。  
  
 次の手順の他に、PAL (パブリケーション アクセス リスト) に必要なログインが登録されていることを確認してください。 PAL の詳細については、次を参照してください。 [パブリッシャーのセキュリティ保護](../../relational-databases/replication/security/secure-the-publisher.md)します。  
  
#### アカウントと権限を構成するには  
  
1.  IIS を実行しているコンピューターでローカル アカウントを作成します。  
  
    1.  右クリック **マイ コンピューター**, 、クリックして **管理**します。  
  
    2.   **コンピューターの管理**, 、展開 **ローカル ユーザーとグループ**します。  
  
    3.  右クリック **ユーザー**, 、クリックして **新しいユーザー**します。  
  
    4.  ユーザー名と複雑なパスワードを入力します。  
  
    5.  クリックして **作成**, 、順にクリック **閉じる**します。  
  
2.  アカウントを IIS_WPG グループに追加します。  
  
    1.   **コンピューターの管理**, 、展開 **ローカル ユーザーとグループ**, 、クリックして **グループ**します。  
  
    2.  右クリック **IIS_WPG**, 、クリックして **グループに追加**します。  
  
    3.   **IIS_WPG のプロパティ** ] ダイアログ ボックスをクリックして **追加**します。  
  
    4.   **[ユーザー、コンピューター、またはグループ** ] ダイアログ ボックスで、手順 1. で作成したアカウントを追加します。  
  
    5.  確認して内の名前、 **この場所から** フィールドは、ドメインではなくローカル コンピューターの名前。 名前がローカル コンピューターではない場合はクリックして **場所**します。  **場所** ] ダイアログ ボックスでは、ローカル コンピューターを選択し、をクリックして **OK**します。  
  
    6.   **ユーザーの選択** ] ダイアログ ボックスおよび **IIS_WPG のプロパティ** ダイアログ ボックスで、をクリックして **[ok]**します。  
  
3.  replisapi.dll が保存されているフォルダーに対する最小限の権限をアカウントに許可します。  
  
    1.  Replisapi.dll 用に作成したフォルダーに移動で、フォルダーを右クリックしてクリックして **共有とセキュリティ**します。  
  
    2.   **セキュリティ** ] タブ、[ **追加**します。  
  
    3.   **[ユーザー、コンピューター、またはグループ** ] ダイアログ ボックスで、手順 1. で作成したアカウントを追加します。  
  
    4.  確認して内の名前、 **この場所から** フィールドは、ドメインではなくローカル コンピューターの名前。 名前がローカル コンピューターではない場合はクリックして **場所**します。  **場所** ] ダイアログ ボックスでは、ローカル コンピューターを選択し、クリックして **OK**します。  
  
    5.  アカウントは、のみが許可されていることを確認 **読み取り**, 、**読み取りと実行**, 、および **フォルダー内容の一覧** アクセス許可。  
  
    6.  [すべてのユーザーまたはグループ、ディレクトリにアクセスする必要を順にクリックしない **削除**します。  
  
    7.  クリックして **OK**です。  
  
4.  アプリケーション プールを作成 **インターネット インフォメーション サービス (IIS) マネージャー**:  
  
    1.  クリックして **開始**, 、順にクリック **実行**します。  
  
    2.   **開く** ボックスに、入力 **inetmgr**, 、順にクリック **OK**します。  
  
    3.   **インターネット インフォメーション サービス (IIS) マネージャー**, 、展開、 **ローカル コンピューター** ノードです。  
  
    4.  右クリック **アプリケーション プール**, 、] をポイント **新規** ] をクリックし、 **アプリケーション プール**します。  
  
    5.  プールの名前を入力、 **アプリケーション プール ID** フィールドに、クリックして **[ok]**します。  
  
5.  アカウントとアプリケーション プールを関連付けます。  
  
    1.   **インターネット インフォメーション サービス (IIS) マネージャー**, 、展開、 **ローカル コンピューター** ノードを順に展開 **アプリケーション プール**します。  
  
    2.  アプリケーション プール] をクリックし、作成したを右クリックして **プロパティ**します。  
  
    3.   **\< ApplicationPoolName> プロパティ** ] ダイアログ ボックスの [、 **Identity** ] タブ、[ **構成可能**します。  
  
    4.   **ユーザー名** と **パスワード** フィールドに、手順 1. で作成されたパスワードとアカウントを入力します。  
  
    5.  クリックして **OK**です。  
  
6.  Web 同期に使用する仮想ディレクトリにアプリケーション プールを関連付けます。  
  
    1.   **インターネット インフォメーション サービス (IIS) マネージャー**, 、展開、 **ローカル コンピューター** ノードを順に展開 **Web サイト**します。  
  
    2.  Web 同期を使用している Web サイトを展開し、Web 同期用に作成した仮想ディレクトリを右クリックし、順にクリックして **プロパティ**します。  
  
    3.   **仮想ディレクトリ** のタブ、 **\< VirtualDirectoryName> プロパティ** ダイアログ ボックスから、 **アプリケーション プール** ドロップダウン リストで、手順 5. で作成されたアプリケーション プールを選択します。  
  
    4.  クリックして **OK**です。  
  
## replisapi.dll への接続のテスト  
 診断モードで Web 同期を実行すると、IIS を実行しているコンピューターへの接続をテストして、SSL (Secure Sockets Layer) 証明書が正しくインストールされているかどうかを確認できます。 診断モードで Web 同期を実行するには、IIS を実行しているコンピューターの管理者である必要があります。  
  
#### replisapi.dll への接続をテストするには  
  
1.  サブスクライバーの LAN (ローカル エリア ネットワーク) が正しく設定されていることを確認します。  
  
    1.   [!INCLUDE[msCoName](../../includes/msconame-md.md)] Internet Explorer で、 **ツール** ] メニューのをクリックして **インターネット オプション**します。  
  
    2.   **接続** ] タブ、[ **LAN の設定**します。  
  
    3.  LAN にプロキシ サーバーを使用しない場合は、オフ **設定を自動的に検出** と **LAN にプロキシ サーバーを使用する**です。  
  
    4.  プロキシ サーバーを使用する場合は、選択 **LAN にプロキシ サーバーを使用する** と **ローカル アドレスに対してプロキシ サーバーを使用しない**します。  
  
    5.  クリックして **OK**です。  
  
2.  サブスクライバー側の Internet Explorer から診断モードでサーバーに接続します。診断モードで接続するには、replisapi.dll のアドレスの後に「 `?diag` 」を追加します。 たとえば、https://server.domain.com/directory/replisapi.dll?diag です。  
  
3.  IIS に指定した証明書は、Windows オペレーティング システムによって認識されない場合、 **セキュリティの警告** ] ダイアログ ボックスが表示されます。 証明書がテスト用の証明書であるか、Windows が認識しない証明機関 (CA) によって発行されていると、この警告が表示されます。  
  
    > [!NOTE]  
    >  このダイアログ ボックスが表示されない場合は、アクセスしているサーバーの証明書が信頼された証明書としてサブスクライバーの証明書ストアに追加されていることが確認されます。 証明書のエクスポートの詳細については、IIS のマニュアルを参照してください。  
  
    1.   **セキュリティの警告** ] ダイアログ ボックスをクリックして **証明書の表示**します。  
  
    2.   **証明書** ] ダイアログ ボックスの [、 **全般** ] タブ、[ **証明書のインストール**します。  
  
    3.  証明書インポート ウィザードを実行します。このウィザードでは既定の値をそのまま使用します。  
  
    4.   **セキュリティの警告** ダイアログ ボックスで、をクリックして **はい**します。  
  
    5.  証明書インポート ウィザードの確認] ダイアログ ボックス [ **OK**します。  
  
    6.  閉じる、 **証明書** ] ダイアログ ボックス。  
  
    7.   **セキュリティの警告** ダイアログ ボックスで、をクリックして **はい**します。  
  
    > [!NOTE]  
    >  ユーザーの証明書がインストールされます。 IIS と同期するユーザーすべてに対してこの手順を実行する必要があります。  
  
4.   **への接続 \< ServerName>** ] ダイアログ ボックスで、ログインと、マージ エージェントが IIS への接続に使用するパスワードを指定します。 これらの資格情報は、サブスクリプションの新規作成ウィザードで指定することもできます。  
  
5.  Internet Explorer ウィンドウで次のように呼び出されます。 **SQL web 同期診断情報**, 、いることを確認の各値 **ステータス** ] ページで列が **成功**します。  
  
6.  証明書がサブスクライバーに正しくインストールされていることを確認します。  
  
    1.  Internet Explorer をいったん閉じてから、再度開きます。  
  
    2.  サーバーに診断モードで接続します。 証明書が正常にインストールされている場合、 **セキュリティの警告** ] ダイアログ ボックスが表示されません。 ダイアログ ボックスが表示される場合は、マージ エージェントから IIS を実行しているコンピューターへの接続に失敗します。 アクセスしているサーバーの証明書が、信頼された証明書としてサブスクライバーの証明書ストアに追加されていることを確認する必要があります。 証明書のエクスポートの詳細については、IIS のマニュアルを参照してください。  
  
## 参照  
 [Web 同期の構成](../../relational-databases/replication/configure-web-synchronization.md)  
  
  