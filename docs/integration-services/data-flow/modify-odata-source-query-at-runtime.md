---
title: "OData ソース クエリを実行時の変更 |Microsoft ドキュメント"
ms.custom: 
ms.date: 03/01/2017
ms.prod: sql-server-2016
ms.reviewer: 
ms.suite: 
ms.technology:
- integration-services
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: bcbba7f4-6e5d-46e6-a73a-3f17d3ff376a
caps.latest.revision: 7
author: douglaslMS
ms.author: douglasl
manager: jhubbard
ms.translationtype: MT
ms.sourcegitcommit: f3481fcc2bb74eaf93182e6cc58f5a06666e10f4
ms.openlocfilehash: e061fe6989d9629d655d9e0c08f2cd4c1d932540
ms.contentlocale: ja-jp
ms.lasthandoff: 08/03/2017

---
# <a name="modify-odata-source-query-at-runtime"></a>実行時の OData ソース クエリの変更
  データ フロー タスクの **[OData ソース].[クエリ]** プロパティに式を追加すると、OData ソースのクエリを実行時に変更できます。  
  
 列が、デザイン時に使用したのと同じ状態にとどまっている必要があることに注意してください。それ以外の場合は、パッケージの実行時にエラーが発生します。 $select クエリ オプションを使用する場合は、同じ列を (同じ順序で) 指定してください。 $select オプションを使用するより安全な代替手段は、ソース コンポーネント UI で、直接使用することを希望しない列を選択解除することです。  
  
 クエリの値を実行時に動的に設定するいくつかの方法があります。 次に、いくつかの一般的な方法を示します。  
  
## <a name="exposing-the-query-as-a-parameter"></a>クエリをパラメーターとして公開  
 次の手順には、OData ソース コンポーネントによって使用されるクエリを、パッケージに対するパラメーターとして公開する手順が含まれています。  
  
1.  **[データ フロー タスク]** を右クリックし、 **[パラメーター化]** オプションを選択します。  
  
2.  **パラメーター化**ダイアログで、 **[\<OData ソース コンポーネントの名前 >] です [。クエリの実行]**の**プロパティ**です。  
  
3.  **[新しいパラメーターの作成]** または **[既存のパラメーターを使用する]**のどちらかを選択します。  
  
4.  **[新しいパラメーターを作成する]**を選択した場合は、次の作業を実行します。  
  
    1.  パラメーターの **[名前]** と **[説明]** を入力します。  
  
    2.  パラメーターの既定の **[値]** を指定します。  
  
    3.  パラメーターに対応する **[スコープ]** (**[パッケージ]** または **[プロジェクト]**) を指定します。  
  
    4.  パラメーターが **[必須]** であるかどうかを指定します。  
  
5.  **[OK]** をクリックして、ダイアログ ボックスを閉じます。  
  
## <a name="using-an-expression"></a>式の使用  
 この方法は、クエリ文字列を実行時に動的に構築する場合役立ちます。 この例では、他の手段 (スクリプト、パラメーターなど) を使用して MaxRows 変数を設定します。  
  
1.  使用中の **[OData ソース]** を含む **[データ フロー タスク]**を選択します。  
  
2.  **[プロパティ]** ウィンドウで、 **[Expressions]** プロパティを強調表示します。  
  
3.  [...] (省略記号) をクリックすると、 **[プロパティ式エディター]**が表示されます。  
  
4.  **[OData ソース].[クエリ]** プロパティを選択します。  
  
5.  [...] (省略記号) ボタンをクリックして**式**です。  
  
6.  **[式]**を入力します。  
  
7.  **[OK]**をクリックします。  
  
> [!WARNING]  
>  この方法を使用する場合、値が、正しくエンコードされた URL であることを確認する必要があります。 ユーザー入力から値を受け取る (たとえば、パラメーターに基づいて個々のクエリ オプションの値を設定する) 場合は、SQL インジェクション型の攻撃の可能性を防止するために、値を検証する必要があります。  
  
  
