---
title: 並列データ ウェアハウスのステージング データベースを使用して |Microsoft ドキュメント
description: SQL Server 並列データ ウェアハウス (PDW) では、ステージング データベースを使用して、読み込みプロセス中に一時的にデータを格納します。
author: mzaman1
manager: craigg
ms.prod: sql
ms.technology: data-warehouse
ms.topic: conceptual
ms.date: 04/17/2018
ms.author: murshedz
ms.reviewer: martinle
ms.openlocfilehash: 73822c1495fa5f83d9a8ba37325a025999f94530
ms.sourcegitcommit: 056ce753c2d6b85cd78be4fc6a29c2b4daaaf26c
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/19/2018
ms.locfileid: "31544660"
---
# <a name="using-a-staging-database-in-parallel-data-warehouse-pdw"></a>並列データ ウェアハウス (PDW) で、ステージング データベースを使用します。
SQL Server 並列データ ウェアハウス (PDW) では、ステージング データベースを使用して、読み込みプロセス中に一時的にデータを格納します。 既定では、SQL Server PDW はテーブルの断片化が発生することができますが、ステージング データベースと転送先データベースを使用します。 テーブルの断片化を解消するには、ユーザー定義のステージング データベースを作成できます。 または、読み込みエラーからのロールバックが問題ではないときに、一時テーブルをスキップし、変換先テーブルに直接読み込むでパフォーマンスを改善する、fastappend 読み込みモードを使用することができます。  
  
## <a name="StagingDatabase"></a>ステージング データベースの基本  
A*ステージング データベース*はアプライアンスに読み込まれるときに一時的にデータを格納するユーザーが作成した PDW データベースです。 負荷のステージング データベースを指定すると、アプライアンスはまずステージング データベースへのデータをコピーし、ステージング データベース内の一時テーブルからコピー先データベースに永続的なテーブルにデータをコピーします。  
  
負荷のステージング データベースが指定されていないと SQL ServerPDW 転送先データベースに一時テーブルを作成、読み込まれたデータを永続的なコピー先のテーブルに挿入する前に、読み込まれたデータを格納するために使用されます。  
  
ロードを使用する場合、 *fastappend モード*、SQL ServerPDW が一時テーブルを完全に使用をスキップし、対象のテーブルに直接データを追加します。 Fastappend モードでは、アプリケーションの観点から、一時テーブルであるテーブルにデータが読み込まれる場所 ELT シナリオの負荷のパフォーマンスを向上します。 たとえば、ELT プロセスでした、一時テーブルにデータを読み込む、クレンジングし、この除外が行われる解除してデータを処理およびターゲット ファクト テーブルにデータを挿入します。 この場合、必要はありません PDW の最初の読み込みを内部の一時テーブルにデータをアプリケーションの一時テーブルにデータを挿入する前にします。 Fastappend モードは、読み込みのパフォーマンスが大幅に向上余分な負荷の手順を回避できます。 Fastappend モードを使用するのには、複数のトランザクション モードで読み込みプロセスにより、失敗または中止負荷からの復旧を処理する必要を使用する必要があります。  
  
**ステージング データベースの利点**  
  
ステージング データベースの主な利点は、テーブルの断片化を解消します。 ステージング データベースを使用しない場合は、転送先データベース内の一時テーブルにデータが読み込まれます。 一時テーブルは、作成して、転送先データベース内で削除された取得、一時テーブルと永続的なテーブルのページは逐次的になります。 時間の経過と共にテーブルの断片化が発生し、パフォーマンスが低下します。 これに対し、ステージング データベースこと一時テーブルが作成され、永続的なテーブルよりも別のファイル領域内で削除されたことを確認します。  
  
**ステージング データベース テーブルの構造**  
  
各データベース テーブルのストレージ構造は、コピー先のテーブルに依存します。  
  
-   ヒープまたはクラスター化列ストア インデックスに読み込まれ、ステージング テーブルはヒープです。  
  
-   行ストア クラスター化インデックスに読み込まれ、ステージング テーブルは行ストア クラスター化インデックスです。  
  
## <a name="Permissions"></a>Permissions  
ステージング データベース (一時テーブルの作成) に対する作成アクセス許可が必要です。 

<!-- MISSING LINKS

For more information, see [Grant Permissions to load data](grant-permissions-to-load-data.md).  

-->
  
## <a name="CreatingStagingDatabase"></a>ステージング データベースを作成するためのベスト プラクティス  
  
1.  アプライアンスごとの 1 つのステージング データベースのみがあります。 すべてのレプリケーション先データベースのすべての読み込みジョブでは、ステージング データベースを共有できます。  
  
2.  ステージング データベースのサイズは、顧客に固有です。 最初に、アプライアンスをまず設定するには、ときに、ステージング データベースは、初期読み込みジョブを十分に格納する必要があります。 これらのロード ジョブに複数の負荷が同時に発生することがあるために大きくなる傾向があります。 初期読み込みのジョブが完了すると、システムが実稼働環境では、各読み込みジョブのサイズが小さくなる可能性があります。 負荷が小さいときは、負荷のサイズが小さくなるを対応するステージング データベースのサイズを小さくことができます。 サイズを減らすためには、ステージング データベースを削除して、再度作成してサイズ割り当てが少ない、または使用することができます、 [ALTER DATABASE](../t-sql/statements/alter-database-parallel-data-warehouse.md)ステートメントです。  
  
    ステージング データベースを作成する場合は、次のガイドラインを使用します。  
  
    -   レプリケートされたテーブルのサイズは、同時にロードするすべてのレプリケートされたテーブルのコンピューティング ノードごとの推定サイズにする必要があります。 サイズは、通常は 25 ~ 30 GB です。  
  
    -   分散テーブルのサイズは、すべての分散テーブルを同時に読み込む、のアプライアンスごとの推定サイズにする必要があります。  
  
    -   ログのサイズは、通常、レプリケートされたテーブルのサイズに似ています。  
  
## <a name="Examples"></a>例  
  
### <a name="a-create-a-staging-database"></a>A. ステージング データベースを作成します。 
次の例では、ステージング、Stagedb、使用してデータベースでは、アプライアンス上のすべての読み込みを伴うを作成します。 5 つのレプリケートされたテーブルのサイズを見積もるとそれぞれ 5 GB が同時に読み込まれます。 この同時実行は、レプリケートされたサイズの 25 GB 以上の割り当てになります。 サイズの 100 のテーブルの 6 つの分散されるを推計しているとすると、200、400、500、500、および 550 GB は同時に読み込まれます。 この同時実行は、分散型のテーブル サイズの 2250 GB 以上の割り当てになります。  
  
```sql  
CREATE DATABASE Stagedb  
WITH (  
  
    AUTOGROW = ON,  
  
    REPLICATED_SIZE = 25 GB,  
  
    DISTRIBUTED_SIZE = 2250 GB,  
  
    LOG_SIZE = 25 GB  
  
);  
```  

<!-- MISSING LINKS
 
## See Also  
[Common metadata query examples](metadata-query-examples.md)  

-->
  
