---
title: カーソルとは何ですか。 | Microsoft Docs
ms.prod: sql
ms.prod_service: drivers
ms.service: ''
ms.component: ado
ms.technology:
- drivers
ms.custom: ''
ms.date: 01/19/2017
ms.reviewer: ''
ms.suite: sql
ms.tgt_pltfrm: ''
ms.topic: conceptual
helpviewer_keywords:
- cursors [ADO], about cursors
ms.assetid: 596eb4b6-c22f-4cde-b23f-172dd66c3161
caps.latest.revision: 10
author: MightyPen
ms.author: genemi
manager: craigg
ms.workload: Inactive
ms.openlocfilehash: 1681bdc14576915d3c9a6833e99d6f0f1c3b95ab
ms.sourcegitcommit: bb044a48a6af9b9d8edb178dc8c8bd5658b9ff68
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/18/2018
---
# <a name="what-is-a-cursor"></a>カーソルとは何ですか。
リレーショナル データベースで操作を実行する場合、行の完全なセットが操作の対象になります。 SELECT ステートメントでは、WHERE 句で指定した条件を満たすすべての行のセットが返されます。 このステートメントが返す行の完全なセットを結果セットと呼びます。 アプリケーション、特に対話型と、オンラインであることはできません常に使用実質的に、結果セット全体の単位として。 そのため、このようなアプリケーションでは、一度に 1 行または少数の行のブロックを使用するためのメカニズムが必要になります。 カーソルはそのメカニズムを提供する結果セットの拡張機能です。  
  
 カーソルは、カーソル ライブラリによって実装されます。 カーソル ライブラリは、ソフトウェア、多くの場合、データベース システムまたはデータ アクセス API の一部として実装されているデータ ソース (結果セット) から返されるデータの属性を管理するために使用です。 これらの属性が、同時実行の管理、行の数が返される結果セットに配置し、前方または後方を移動するかどうか (または両方) 結果を設定 (スクロール) します。  
  
 カーソルの結果セット内の位置を追跡し、有無にかかわらず、元のテーブルを返すことで、結果セットに対して 1 行ずつの複数の操作を実行することができます。 つまり、カーソルでは、概念的には、データベース内のテーブルに基づく結果セットを返します。 カーソルには、結果セット内の現在位置を示すためためを名前は、コンピューター画面上にカーソルが現在の位置を示すと同様です。  
  
 ADO では、その使用方法の詳細について移動する前に、カーソルの概念の理解に重要です。  
  
 カーソルを使用するには、次のことができます。  
  
-   結果セット内の特定の行の位置を指定します。  
  
-   1 つの行または現在の結果セットの位置に基づいて行のブロックを取得します。  
  
-   結果セット内の現在位置にある行のデータを変更します。  
  
-   他のユーザーによって行われたデータ変更には、さまざまなレベルの応答性を定義します。  
  
 たとえば、潜在的な購入者に使用可能な製品の一覧を表示するアプリケーションを検討してください。 購入者は、製品の詳細とコストを表示する一覧をスクロールし、最後に購入する製品を選択します。 さらにスクロールして選択範囲は、一覧の残りの部分に発生します。 購入者は、に関しては、できる限り、一度に 1 つの製品が表示されますが、アプリケーションでは、スクロール可能なカーソルを使用して、結果セットを上下に参照します。  
  
 さまざまな方法でカーソルを使用することができます。  
  
-   すべての行の存在しません。  
  
-   一部またはすべての 1 つのテーブルの行。  
  
-   一部またはすべての論理的に結合されたテーブルから行です。  
  
-   読み取り専用またはとカーソルまたはフィールドのレベルで更新可能です。  
  
-   順方向専用または完全にスクロールします。  
  
-   で、カーソルのキーセットはサーバーにあります。  
  
-   (メンバーシップ、並べ替え、挿入、更新、および削除) などの他のアプリケーションで発生した基になるテーブルの変更に影響します。  
  
-   サーバーまたはクライアントに存在します。  
  
 読み取り専用カーソルでは、結果セットを参照し、読み取り/書き込みのカーソルは、個々 の行の更新を実装できますユーザーを支援します。 ベース テーブルの行を指すキーセットでは、複雑なカーソルを定義することができます。 一部のカーソルは読み取り専用で前方には、他のユーザー前後に移動し、その他のアプリケーションが実行するデータベースの変更に基づいて、結果セットを動的に更新を提供できます。  
  
 すべてのアプリケーションは、アクセスや更新データにカーソルを使用する必要があります。 単にいくつかのクエリの行の出力がカーソルを使用する更新とは不要です。 カーソルが最後にデータを取得する方法のいずれかにする必要があります: し、カーソルを使用する場合は、影響が最も低いカーソルを選択する必要があります。 結果セットがカーソルを使用して更新可能ではありませんが、ストアド プロシージャを使用して結果セットを作成するときに編集方法または更新します。  
  
## <a name="concurrency"></a>同時実行  
 マルチ ユーザー アプリケーションによっては、できるだけ最新であるエンドユーザーに表示されるデータの非常に重要ですが。 そのようなシステムの典型的な例は、航空券予約システムでは、特定のフライト (およびそのため、1 つのレコード) 同じ座席の多くのユーザーを競合する可能性があります。 次のような場合は、アプリケーションの設計は、レコードを 1 つの同時実行操作を処理する必要があります。  
  
 他のアプリケーションでは、同時実行は、重要ではありません。 このような場合は、常に現在のデータを保持しておくに関連するコストを正当化ことはできません。  
  
## <a name="position"></a>[位置]  
 カーソルもの追跡、結果セット内の現在位置。 思われるのと同様の現在のレコードへのポインターとしてのカーソル位置の配列、配列内の特定の場所にある値をインデックス ポイント。  
  
## <a name="scrollability"></a>スクロール可能  
 アプリケーションで採用されているカーソルの種類も影響を受ける機能を結果セット内の行を前方と後方に移動するにはこれは、スクロール機能と呼ばれます。 前方に移動する機能*と*結果を旧バージョンとセットは、カーソルの複雑さを追加し、実装する高価であるためです。 このため、必要な場合にのみ、この機能によりカーソルを要求する必要があります。
