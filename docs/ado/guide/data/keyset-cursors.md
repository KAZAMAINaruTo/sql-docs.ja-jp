---
title: "Keyset カーソル |Microsoft ドキュメント"
ms.prod: sql-non-specified
ms.technology:
- drivers
ms.custom: 
ms.date: 01/19/2017
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- Keyset cursors [ADO]
- cursors [ADO], Keyset
ms.assetid: 14b51b17-6fd9-4146-af45-ca4b0fe6d48a
caps.latest.revision: 5
author: MightyPen
ms.author: genemi
manager: jhubbard
ms.translationtype: MT
ms.sourcegitcommit: f7e6274d77a9cdd4de6cbcaef559ca99f77b3608
ms.openlocfilehash: 8def959d69c353449c2f862638d6edd54f786624
ms.contentlocale: ja-jp
ms.lasthandoff: 09/09/2017

---
# <a name="keyset-cursors"></a>Keyset カーソル
キーセット カーソルは、変更を検出する機能で、静的および動的カーソルの間での機能を提供します。 静的カーソルと同様に常に検出されない、メンバーシップと、結果セットの順序を変更します。 動的カーソルの場合と同様には、行の値への変更を検出、結果セットに。  
  
 キーセット ドリブン カーソルでは、キーセットという一意の識別子 (キー) のセットによって制御されます。 これらのキーは、結果セットの行を一意に識別する列のセットから構築されます。 キーセットは、クエリ ステートメントによって返されるすべての行からのキー値のセットです。  
  
 キーセット ドリブン カーソルとキーが構築されたカーソルの行ごとおよび保存クライアント ワークステーションまたはサーバー上に格納します。 各行をアクセスすると、データ ソースからデータの現在の値をフェッチする格納されたキーが使用されます。 カーソル、キーセット ドリブン カーソル、キーセットが完全に作成するときに結果セットのメンバーシップが凍結されます。 その後、メンバーシップに影響する追加や更新はありませんが再び開かれるまで、結果セットの一部です。  
  
 ユーザーが結果セットをスクロールしても、(キーセットの所有者または他のプロセスによって行われた) データ値への変更が表示されます。 カーソルの外部 (他のプロセス) によって行われた挿入は、カーソルを閉じて、再び開く場合にのみ表示されます。 カーソル内で行われた挿入は、結果セットの最後に表示されます。  
  
 キーセット ドリブン カーソルが削除された行を取得しようとすると、行が結果セット内の「穴」として表示されます。 キーセット内の行のキーが存在しますが、行が結果セットに存在しません。 行のキー値が更新された場合、行と見なされますが削除され、挿入、ため、このような行が結果セットに穴としても表示されます。 キーセット ドリブン カーソルでは、他のプロセスによって削除された行を検出できる常に、中に自分自身を削除した行のキーを必要に応じて削除できます。 証拠が削除されたために、キーセット ドリブン カーソルでこれを実行するは、独自の削除を検出できません。  
  
 キー列への更新は、新しいキーの挿入が前のキーの削除と同様に動作します。 新しいキーの値は、更新プログラムが、カーソルによって行われたいない場合に表示されません。 更新プログラムが、カーソルによって行われた場合、新しいキー値が結果セットの末尾に追加されます。  
  
 標準的なカーソルのキーセット ドリブンと呼ばれる、キーセット ドリブン カーソルのバリエーションがあります。 キーセット ドリブンの標準的なカーソルが、カーソルが開いたとき、カーソル所有者によって行われた値が変更に結果セット内の行のメンバーシップ、および行の順序が固定し、他のプロセスによるコミットされた変更が表示されます。 変更行のメンバーシップの条件を満たしませんまたは行の順序に影響は、行が消えるやしません、カーソルを閉じて、再び開く場合を除き、移動。 挿入されたデータが表示されませんが、既存のデータへの変更が、行がフェッチされますように表示します。  
  
 キーセット ドリブン カーソルは、適切に使用するデータ変更に対する応答は、多くのさまざまな状況に依存するため前述困難です。 ただし、アプリケーションは、同時実行更新ではない、誤ったキーをプログラムで処理することができます、特定のキーを持つ行に直接アクセスする必要がある場合、キーセット ドリブン カーソルが適しています。 使用して、 **adOpenKeyset CursorTypeEnum** ADO でキーセット カーソルを使用することを示すためにします。  
  
## <a name="see-also"></a>参照  
 [順方向専用カーソル](../../../ado/guide/data/forward-only-cursors.md)   
 [静的カーソル](../../../ado/guide/data/static-cursors.md)   
 [動的カーソル](../../../ado/guide/data/dynamic-cursors.md)
