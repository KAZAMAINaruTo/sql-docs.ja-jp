---
title: INDEX コマンド |Microsoft ドキュメント
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: drivers
ms.service: ''
ms.component: odbc
ms.reviewer: ''
ms.suite: sql
ms.technology:
- drivers
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- index command [ODBC]
ms.assetid: 694e8cf5-2f69-4001-9c1e-b735a4da3aff
caps.latest.revision: 5
author: MightyPen
ms.author: genemi
manager: craigg
ms.workload: Inactive
ms.openlocfilehash: b989e45c8a3779108316358d34df472103a71676
ms.sourcegitcommit: 7a6df3fd5bea9282ecdeffa94d13ea1da6def80a
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/16/2018
---
# <a name="index-command"></a>INDEX コマンド
インデックス ファイルを表示し、論理的な順序でテーブルのレコードへのアクセスを作成します。  
  
## <a name="syntax"></a>構文  
  
```  
  
INDEX ON eExpression TO IDXFileName | TAG TagName [OF CDXFileName]  
   [FOR lExpression]  
   [COMPACT]  
   [ASCENDING | DESCENDING]  
   [UNIQUE | CANDIDATE]  
   [ADDITIVE]  
```  
  
## <a name="arguments"></a>引数  
 *eExpression*  
 フィールドまたは現在のテーブルからのフィールドの名前を含めることができるインデックスの式を指定します。 テーブル内の各レコードのインデックス ファイルで、インデックスの式に基づくインデックス キーが作成されます。 Visual FoxPro では、これらのキーを使用して、表示し、テーブル内のレコードにアクセスします。  
  
> [!NOTE]  
>  推奨されませんが、 *eExpression*メモリ変数、配列要素、またはフィールドまたは別の作業領域内のテーブルからのフィールド式を指定できますも。 メモ フィールドは、インデックス ファイルの式で単独で使用することはできません。これらは、その他の文字式と組み合わせる必要があります。 変数またはフィールドを不要になった配置することはできませんが存在することも含まれているインデックスにアクセスする場合、Visual FoxPro はエラー メッセージを生成します。  
  
 長さが変化するキーを使用してインデックスを作成しようとする場合は、スペースを含む、キーが埋め込まれます。 可変長のインデックス キーは、Visual FoxPro でサポートされていません。  
  
 長さが 0 で、インデックス キーを作成することができます。 たとえば、インデックス式が空のフィールドの部分文字列の場合、長さゼロ インデックス キーが作成されます。 長さゼロ インデックス キーには、エラー メッセージが生成されます。 Visual FoxPro は、インデックスを作成するときに、テーブルの最初のレコードのフィールドを評価します。 フィールドが空の場合は、長さが 0 のインデックス キーを防ぐために最初のレコードのフィールドに一時データの一部を入力する必要があります。  
  
 *IDXFileName*  
 .Idx インデックス ファイルを作成します。 インデックス ファイルには、既定の拡張子 .idx が与えられます。  
  
 タグ*TagName*[OF *CDXFileName*]  
 複合インデックス ファイルを作成します。 複合インデックス ファイルは、任意の数の個別のタグ (インデックス エントリ) で構成される 1 つのインデックス ファイルです。 各タグは、その一意のタグ名によって識別されます。 タグ名は、文字またはアンダー スコアで始まる必要がありますおよび最大 10 個の文字、数字、またはアンダー スコアの任意の組み合わせで構成できます。 複合インデックス ファイル内のタグの数は、使用可能なメモリとディスク容量によってのみ制限されます。  
  
 複数のエントリの複合インデックス ファイルが compact では常にします。 複合インデックス ファイルを作成するときに、最適化を含める必要はありません。 複合インデックス ファイルの名前には、.cdx 拡張機能が与えられます。  
  
 複合インデックス ファイルの 2 つの種類を作成できます。 構造と構造です。  
  
 **構造の複合インデックス ファイル**構造上の複合インデックス ファイルを作成するにはタグを持つ*TagName*省略可能なを除外することにより*CDXFileName*句。 複合インデックスの構造上のファイルは常にテーブルと同じ基本名を持つし、テーブルを開いたときに自動的に開かれます。  
  
 **構造の複合インデックス ファイル**OF を含めることによって、構造の複合インデックス ファイルを作成できます*CDXFileName*タグの後に*TagName*です。 構造の複合インデックス ファイルとは異なり、構造の複合インデックス ファイル開く必要があります明示的に使用 INDEX 句を使用します。  
  
 複合インデックス ファイルは既に作成されていて開く、タグを持つインデックスを発行する*TagName*複合インデックスのファイルにタグを追加します。  
  
 *LExpression*  
 これにより、条件を指定します、フィルター式を満たすレコードだけ*lExpression*表示とアクセス; 使用可能なインデックス キーは、フィルター式に一致するには、これらのレコードのインデックス ファイルに作成します。  
  
 Visual FoxPro Rushmore テクノロジは、インデックスを最適化しています.*LExpression*コマンドが*lExpression*最適化可能な式を指定します。 最適なパフォーマンスを最適化の式を使用して、FOR 句でします。  
  
 COMPACT  
 Compact .idx ファイルを作成します。  
  
 昇順  
 .Cdx ファイルの昇順を指定します。 既定では、.cdx タグは、昇順に作成されます。 ([昇順] は、インデックス ファイルの順序のアラームとして含めることができます)。テーブルは、降順を含めることによって逆の順序でインデックスことができます。  
  
 降順  
 降順 .cdx ファイルを指定します。 .Idx インデックス ファイルを作成するときに、降順を含めることはできません。  
  
 UNIQUE  
 .Idx ファイルまたは .cdx タグで特定のインデックス キーの値を持つ見つかった最初のレコードのみが含まれることを指定します。 UNIQUE は、重複するレコードの表示またはアクセスを防ぐために使用できます。 重複するインデックスのキーを持つ追加されたすべてのレコードは、インデックス ファイルから除外されます。 インデックスの一意のオプションを使用することは、インデックスまたはインデックスの再作成を発行する前にセット UNIQUE ON を実行すると同じです。  
  
 一意のインデックスまたはインデックスのタグがアクティブであり、インデックス キーを変更した方法で重複するレコードの変更、インデックスまたはインデックスのタグが更新されます。 ただし、次の重複するレコードを元のインデックス キー アクセスできないかまたは再インデックス化を使用して、ファイルを再作成するまで表示されます。  
  
 候補  
 候補構造のインデックスのタグを作成します。 構造的なインデックス タグを作成するときにのみ、候補キーワードが含まれるできます。それ以外の場合、Visual FoxPro には、エラー メッセージが生成されます。  
  
 フィールドまたはインデックスの式で指定されたフィールドの組み合わせで、重複を防止する候補インデックス タグ*eExpression*です。 という用語は、*候補*; インデックスの種類を指すため、候補となるインデックスは、重複する値を防ぐため、これらは、プライマリ インデックスである「候補」と対象です。  
  
 Visual FoxPro は、フィールドまたは重複する値が格納されているフィールドの組み合わせの候補インデックス タグを作成する場合に、エラーを生成します。  
  
 加法  
 保持は、既に開かれているインデックス ファイルを開きます。 インデックスを持つインデックス ファイルまたはテーブルのファイルを作成するときに、加法句を省略した場合 (構造体の複合インデックス) を除くすべてのインデックスが既に開かれているファイルは閉じられます。  
  
## <a name="remarks"></a>解説  
 インデックス ファイルがあるテーブル内のレコードが表示され、インデックスの式で指定された順序でアクセスします。 テーブル内のレコードの物理的な順序は、インデックスにあるファイルで変更されていません。  
  
## <a name="index-types"></a>インデックスの種類  
 Visual FoxPro では、2 種類のインデックス ファイルを作成できます。  
  
-   複合 .cdx インデックス ファイルのタグと呼ばれる複数のインデックス エントリが格納されます。  
  
-   1 つのインデックス エントリを含む .idx インデックス ファイル  
  
 テーブルに自動的に開かれる構造型の複合インデックス ファイルを作成することもできます。  
  
> [!NOTE]  
>  構造の複合インデックス ファイルが自動的に開かれるため、テーブルを開いたときに、推奨されるインデックスの種類はします。  
  
 Compact .idx インデックス ファイルを作成する最適化が含まれます。 複合インデックスのファイルは、コンパクトでは常にします。  
  
## <a name="index-order-and-updating"></a>インデックスの順序と更新  
 1 つだけのインデックス ファイル (マスター インデックス ファイル) またはタグ (マスター タグ) は、テーブルが表示またはアクセスの順序を制御します。 特定のコマンド (たとえば、シーク) は、レコードを検索するマスター インデックスのファイルまたはタグを使用します。 ただし、すべて .idx を開き、テーブルに変更が加えられる .cdx インデックス ファイルが更新されます。  
  
## <a name="user-defined-functions"></a>ユーザー定義関数  
 インデックス式は、ユーザー定義関数を含めることができますは、インデックスの式でユーザー定義関数を使用する必要がありますされません。 インデックス式の中で、ユーザー定義関数には、作成またはインデックスを更新するまでにかかる時間が増加します。 インデックスの更新は可能性があります、インデックスの式、ユーザー定義関数を使用する場合は実行されません。  
  
 インデックス式で、ユーザー定義関数を使用する場合、Visual FoxPro はユーザー定義関数を検索できる必要があります。 Visual FoxPro、インデックスを作成すると、インデックスの式は、インデックス ファイルに保存されますが、インデックスの式で、ユーザー定義関数への参照だけが含まれています。  
  
## <a name="see-also"></a>参照  
 [ALTER TABLE の SQL コマンド](../../odbc/microsoft/alter-table-sql-command.md)   
 [タグ コマンドを削除します。](../../odbc/microsoft/delete-tag-command.md)   
 [SET COLLATE コマンド](../../odbc/microsoft/set-collate-command.md)   
 [SET UNIQUE コマンド](../../odbc/microsoft/set-unique-command.md)
