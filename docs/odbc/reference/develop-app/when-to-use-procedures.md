---
title: "プロシージャを使用するときに |Microsoft ドキュメント"
ms.custom: 
ms.date: 01/19/2017
ms.prod: sql-non-specified
ms.reviewer: 
ms.suite: 
ms.technology:
- drivers
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- SQL statements [ODBC], procedures
- procedures [ODBC], about procedures
ms.assetid: 7dc9e327-dd54-4b10-9f66-9ef5c074f122
caps.latest.revision: 6
author: MightyPen
ms.author: genemi
manager: jhubbard
ms.workload: Inactive
ms.translationtype: MT
ms.sourcegitcommit: f7e6274d77a9cdd4de6cbcaef559ca99f77b3608
ms.openlocfilehash: a7bae5e984d66d8b71a9e4b84708f3ea126c1e0b
ms.contentlocale: ja-jp
ms.lasthandoff: 09/09/2017

---
# <a name="when-to-use-procedures"></a>プロシージャを使用する場合
プロシージャを使用する利点を次の数と、すべて、という事実に基づいてプロシージャを使用して SQL ステートメントから移動、アプリケーション、データ ソースをします。 新機能はのまま、アプリケーションには、相互運用可能なプロシージャ呼び出しです。 これらの利点は次のとおりです。  
  
-   **パフォーマンス**プロシージャは、通常 SQL ステートメントを実行する最も簡単な方法です。 同様に実行を準備するには、ステートメントをコンパイルおよび 2 つの個別の手順で実行します。 準備実行とは異なり、プロシージャが実行時にのみ実行されます。 別の時間にコンパイルされます。  
  
-   **ビジネス ルール**A*ビジネス ルール*を会社はビジネス方法に関する規則。 たとえば、新しい販売注文を追加する販売員のタイトルを持つユーザーだけ許可可能性があります。 プロシージャでこれらのルールを配置することにより、個々 の企業アプリケーション コードを変更することがなく、アプリケーションから呼び出されたプロシージャの書き直しを垂直方向のアプリケーションをカスタマイズします。 たとえば、受注アプリケーションは、プロシージャを呼び出す可能性があります**InsertOrder**固定数のパラメーター以外で正確にどのように**InsertOrder**は実装されて会社を変更できます。  
  
-   **Replaceability**アプリケーションを再コンパイルしなくてもプロシージャを置き換えることができます、ファクトは、プロシージャのビジネス ルールを配置することに密接に関連します。 会社が購入し、アプリケーションのインストール後にビジネス ルールが変更された場合、会社は、そのルールを含むプロシージャを変更できます。 アプリケーションの観点では、何も変更されました。引き続き、特定のタスクを実行する特定のプロシージャを呼び出します。  
  
-   **DBMS に固有の SQL**プロシージャがアプリケーションに DBMS に固有の SQL を利用し、引き続き相互運用可能な方法を提供します。 たとえば、SQL の流れ制御ステートメントをサポートする DBMS での手順は、トラップして、流れ制御ステートメントをサポートしていない DBMS での手順にエラーが返される可能性がありますだけ中に、エラーから回復します。  
  
-   **プロシージャには、トランザクションが後も存続**トランザクションがコミットまたはロールバック時に一部のデータ ソースの接続ですべての準備されたステートメントのアクセス プランが削除されました。 永続的に、データ ソースに保存されている、この手順で SQL ステートメントを配置することにより、ステートメントは、トランザクションも存続します。 手順が、準備された、準備された部分的に存続するかどうか、または準備未完の状態は、DBMS に固有です。  
  
-   **開発を区切る**プロシージャは、アプリケーションの他の部分とは別に開発できます。 大規模な企業では、さらに非常に特殊なプログラマのスキルを活用する方法を達成この可能性があります。 つまり、アプリケーション プログラマは、ユーザー インターフェイスのコードを記述でき、データベース プログラマは、プロシージャを作成できます。  
  
 プロシージャは、垂直方向およびカスタム アプリケーションで一般的に使用されます。 これらのアプリケーションが固定のタスクを実行する傾向がありにハード コード プロシージャ呼び出しを行うことができます。 たとえば、受注アプリケーションは、プロシージャを呼び出す可能性があります**InsertOrder**、 **DeleteOrder**、 **UpdateOrder**、および**GetOrders**.  
  
 汎用アプリケーションからプロシージャを呼び出す理由はほとんどがありません。 特定のアプリケーションのコンテキストでタスクを実行する手順は通常、作成や、汎用的なアプリケーションを使用します。 たとえば、スプレッドシートを持たないを呼び出す理由、 **InsertOrder**に説明した手順。 さらに、汎用アプリケーション構成しないでプロシージャ実行時ステートメントの実行速度が速く; を提供する使用だけでなく、この準備された、直接実行するよりも低速である可能性が DBMS に固有の SQL ステートメントも必要です。  
  
 この例外は、多くの場合、プロシージャを実行し、プロシージャをテストするプログラマのための方法が提供する SQL ステートメントを構築するプログラマのための手段を提供するアプリケーションの開発環境です。 このような環境呼び出し**SQLProcedures**リストの使用可能な手順と**SQLProcedureColumns**値、および列の入力、入力/出力、および出力パラメーターを一覧表示するプロシージャを返すプロシージャによって作成された結果セットです。 ただし、このような手順の開発が必要事前; 各データ ソースに対するため、これには、DBMS に固有の SQL ステートメントが必要です。  
  
 プロシージャの使用に 3 つの大きな欠点があります。 最初は、プロシージャの記述し、アプリケーションを実行する各 DBMS 用にコンパイルする必要があることです。 これはカスタム アプリケーションの問題ではありません、開発およびメンテナンス時刻を垂直方向のアプリケーションをさまざまな Dbms を実行するように設計に可能性が高まります。  
  
 2 つ目の欠点は、多くの Dbms によってプロシージャがサポートされないことです。 ここでも、さまざまな Dbms を実行するように設計垂直方向のアプリケーションの問題が発生する可能性がします。 アプリケーションを呼び出すプロシージャがサポートされているかどうかを判断するのに**SQLGetInfo** SQL_PROCEDURES オプションを使用します。  
  
 3 つ目の欠点は、特にアプリケーションの開発環境に適切であるが、ODBC には、プロシージャを作成するための標準的な文法は定義しません。 つまり、アプリケーションでは、interoperably プロシージャを呼び出すことができます、これらは作成できません interoperably。

