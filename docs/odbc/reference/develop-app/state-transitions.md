---
title: "状態遷移 |Microsoft ドキュメント"
ms.custom: 
ms.date: 01/19/2017
ms.prod: sql-non-specified
ms.reviewer: 
ms.suite: 
ms.technology:
- drivers
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- state transitions [ODBC]
- unallocated state [ODBC]
- handles [ODBC], state transitions
- allocated state [ODBC]
- connection state [ODBC]
ms.assetid: fc741611-6535-43cc-8156-6d897d04664e
caps.latest.revision: 5
author: MightyPen
ms.author: genemi
manager: jhubbard
ms.workload: Inactive
ms.translationtype: MT
ms.sourcegitcommit: f7e6274d77a9cdd4de6cbcaef559ca99f77b3608
ms.openlocfilehash: 42aedfe48871b04b311fb5de31fb9866e0e2468c
ms.contentlocale: ja-jp
ms.lasthandoff: 09/09/2017

---
# <a name="state-transitions"></a>状態遷移
ODBC 定義不連続*状態*の各環境や接続ごとに、各ステートメント。 たとえば、環境には 3 つの状態: (する環境が割り当てられていない) で、未割り当て、割り当てられた (を環境が割り当てられますが、接続が割り当てられていません)、および接続 (環境とがである 1 つまたは複数の接続割り当てられている)。 接続がある 7 つの可能な状態です。ステートメントが 13 の可能な状態であります。  
  
 特定のアイテムのハンドルによって識別された 1 つの状態から別に移動アプリケーションが特定の関数または関数を呼び出すし、そのアイテムへのハンドルを渡します。 このような動きが呼び出された、*状態*です。 たとえば、使用環境ハンドルの割り当て**SQLAllocHandle**未割り当てから未使用の割り当て、使用してそのハンドルを解放して、環境を移動**SQLFreeHandle**に未使用の割り当てを返します未割り当てです。 ODBC では、特定の順序で関数を呼び出す必要があるというメッセージが別の方法は有効な状態遷移の数に制限を定義します。  
  
 などのいくつかの関数**SQLGetConnectAttr**状態はまったく影響しません。 その他の関数では、単一の項目の状態に影響します。 たとえば、 **SQLDisconnect**割り当て済みの状態に接続の状態からの接続を移動します。 最後に、一部の関数では、1 つ以上の項目の状態に影響します。 たとえばと接続ハンドルの割り当て**SQLAllocHandle**割り当て済みの状態に、未割り当てからの接続を移動し、接続状態を未使用の割り当てから環境を移動します。  
  
 かどうか、アプリケーションが順序どおり関数を呼び出す関数を返します、*状態遷移エラー*です。 たとえば、次の環境と接続状態と、アプリケーションでは呼び出し**SQLFreeHandle**その環境ハンドルを持つ**SQLFreeHandle** SQLSTATE HY010 を返します (関数のシーケンス エラー)、環境が割り当てられている状態の場合にのみ呼び出すことができます。 無効な状態遷移とは、これを定義することでは、ODBC がアクティブな接続があるときに、環境を解放するアプリケーションを防止します。  
  
 いくつかの状態遷移は、ODBC のデザインに固有です。 たとえば、接続ハンドルの割り当てを行う関数は、環境ハンドルを必要とするため、最初に、環境ハンドルを割り当てずに、接続ハンドルを割り当てることはできません。 その他の状態遷移は、ドライバー マネージャーと、ドライバーによって適用されます。 たとえば、 **SQLExecute**準備されたステートメントを実行します。 ステートメント ハンドルが渡された場合になっていない準備された状態では、 **SQLExecute** SQLSTATE HY010 を返します (関数のシーケンス エラーです)。  
  
 アプリケーションの観点から見る、状態遷移は、通常は単純です: 有効な状態遷移が手での手の形を移動する傾向がありますと適切に記述されたアプリケーションのフロー。 状態遷移は、環境、接続ごとに、および各ステートメントの状態を追跡する必要があるため、ドライバー マネージャーとドライバーの複雑です。 この作業の大部分は、ドライバー マネージャーによって; で行われますドライバーで行う必要がある作業のほとんどは、保留中の結果を持つステートメントで発生します。  
  
 このマニュアルの部分を 1 と 2 (「ODBC の概要」および「アプリケーションとドライバーの開発」) の状態遷移を明示的に言うまでもなく傾向があります。 代わりに、関数を呼び出す必要があります、順序、について説明します。 たとえば、「を実行するステートメント」は状態と、ステートメントを準備する必要があります**SQLPrepare**をで実行する前に**SQLExecute**です。 状態と遷移には、ドライバー マネージャーによってがチェックされ、これは、ドライバーでチェックする必要がありますを含む、状態遷移の詳細については、次を参照してください。[付録 b: ODBC 状態遷移表](../../../odbc/reference/appendixes/appendix-b-odbc-state-transition-tables.md)です。

