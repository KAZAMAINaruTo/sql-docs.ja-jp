---
title: キーセット ドリブン カーソル |Microsoft ドキュメント
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: drivers
ms.service: ''
ms.component: odbc
ms.reviewer: ''
ms.suite: sql
ms.technology:
- drivers
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- keyset-driven cursors [ODBC]
- cursors [ODBC], key-set driven
ms.assetid: 01769f43-1d9c-4685-84fa-15a6465335e9
caps.latest.revision: 5
author: MightyPen
ms.author: genemi
manager: craigg
ms.workload: Inactive
ms.openlocfilehash: acc3a757493c935d5b37c278eb77b9b849f85873
ms.sourcegitcommit: 7a6df3fd5bea9282ecdeffa94d13ea1da6def80a
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/16/2018
---
# <a name="keyset-driven-cursors"></a>キーセット ドリブン カーソル
キーセット ドリブン カーソルは、静的および動的カーソルの間で変更を検出する機能にあります。 静的カーソルと同様に常に検出されない、メンバーシップと、結果セットの順序を変更します。 動的カーソルの場合と同様には、行の値が変更を検出、結果セット (SQL_ATTR_TXN_ISOLATION 接続属性によって設定された、トランザクションの分離レベル) に従います。  
  
 キーセット ドリブン カーソルを開いたときに、結果セット全体のキーが保存されます。これにより、見かけ上のメンバーシップと、結果セットの順序を修正します。 このキーを使用、カーソルが結果セットをスクロールと*キーセット*各行の現在のデータ値を取得します。 たとえば、キーセット ドリブン カーソルは行と他のアプリケーションをフェッチし、行を更新します。 カーソルは、行を変わりません場合に、表示される値は新しいため、そのキーを使用して行を再フェッチです。 このため、キーセット ドリブン カーソルは常に自身や他のユーザーによって行われた変更を検出します。  
  
 カーソルが削除された行を取得しようとすると、結果セット内の「穴」としてこの行が表示されます。: キーセット内の行のキーが存在しますが、行が結果セットに存在しません。 行のキー値が更新された場合、行と見なされますが削除され、挿入、ため、このような行が結果セットに穴としても表示されます。 キーを必要に応じて削除できますが、キーセット ドリブン カーソルは、他のユーザーによって削除された行を常に検出できます、中に行をそれ自体から削除キーセットです。 キーセット ドリブン カーソルでこれを実行するには、独自の削除を検出できません。 SQL_STATIC_SENSITIVITY オプションによって、特定のキーセット ドリブン カーソルがそれ自体の削除を検出するかどうかは報告**SQLGetInfo**です。  
  
 他のユーザーによって挿入された行をキーセット ドリブン カーソルに表示されるは、キーセットにこれらの行のキーが存在しないためことはできません。 ただし、キーセット ドリブン カーソルには、キーが追加できます必要に応じて行の挿入自体キーセットをします。 キーセット ドリブン カーソルでこれを実行するには、独自の挿入を検出できます。 SQL_STATIC_SENSITIVITY オプションによって、特定のキーセット ドリブン カーソルがそれ自体の挿入を検出するかどうかは報告**SQLGetInfo**です。  
  
 SQL_ATTR_ROW_STATUS_PTR ステートメント属性によって指定された行の状態配列では、任意の行の SQL_ROW_SUCCESS、SQL_ROW_SUCCESS_WITH_INFO、または SQL_ROW_ERROR を含めることができます。 SQL_ROW_UPDATED SQL_ROW_DELETED、SQL_ROW_ADDED として更新された、検出した行の削除、または、挿入を返します。  
  
 キーセット ドリブン カーソルでは、結果セットの各行のキーを格納する一時テーブルを作成することで一般的な実装されます。 カーソルは、行が更新されているかどうかも決定する必要があります、ために、このテーブルには行バージョン管理情報を持つ列もよく含まれています。  
  
 元の結果セットをスクロールするには、キーセット ドリブン カーソルは、一時テーブルには静的カーソルを開きます。 元の結果セット内の行を取得するには、カーソルは最初に、一時テーブルから適切なキーを取得や、行の現在の値を取得します。 ブロック カーソルを使用している場合、カーソルは複数のキーと行を取得する必要があります。
